{"name":"game_insights","version":"1769953545450","created_version":"1769953545450","type":"VIEW","sql":"SELECT *, main.date_part('hour', end_time) AS hour_utc, main.date_part('DOW', end_time) AS day_of_week, strftime(end_time, '%A') AS day_name, CASE  WHEN (((white_result = 'win') AND (rating_diff \u003c -100))) THEN ('White Upset (underdog wins)') WHEN (((black_result = 'win') AND (rating_diff \u003e 100))) THEN ('Black Upset (underdog wins)') WHEN (((white_result = 'win') AND (rating_diff \u003e 100))) THEN ('Favorite wins (white)') WHEN (((black_result = 'win') AND (rating_diff \u003c -100))) THEN ('Favorite wins (black)') WHEN ((winner IS NULL)) THEN ('Draw') ELSE 'Close match' END AS upset_category, CASE  WHEN (((white_result = 'win') AND (rating_diff \u003c -100))) THEN (CAST('t' AS BOOLEAN)) WHEN (((black_result = 'win') AND (rating_diff \u003e 100))) THEN (CAST('t' AS BOOLEAN)) ELSE CAST('f' AS BOOLEAN) END AS is_upset, CASE  WHEN ((abs(rating_diff) \u003c 50)) THEN ('Even match (Â±50)') WHEN ((abs(rating_diff) \u003c 100)) THEN ('Slight edge (50-100)') WHEN ((abs(rating_diff) \u003c 200)) THEN ('Clear favorite (100-200)') WHEN ((abs(rating_diff) \u003c 400)) THEN ('Big mismatch (200-400)') ELSE 'Massive gap (400+)' END AS rating_gap_bucket, CASE  WHEN (((white_result = 'checkmated') OR (black_result = 'checkmated'))) THEN ('Checkmate') WHEN (((white_result = 'resigned') OR (black_result = 'resigned'))) THEN ('Resignation') WHEN (((white_result = 'timeout') OR (black_result = 'timeout'))) THEN ('Timeout') WHEN (((white_result = 'abandoned') OR (black_result = 'abandoned'))) THEN ('Abandoned') WHEN (((white_result IN ('stalemate', 'agreed', 'repetition', 'insufficient', '50move')) OR (black_result IN ('stalemate', 'agreed', 'repetition', 'insufficient', '50move')))) THEN ('Draw') ELSE 'Other' END AS termination_type, CASE  WHEN ((rating_diff \u003e 50)) THEN ('White favored') WHEN ((rating_diff \u003c -50)) THEN ('Black favored') ELSE 'Even' END AS pre_game_favorite, CASE  WHEN (((rating_diff \u003e 50) AND (white_result = 'win'))) THEN ('Favorite won') WHEN (((rating_diff \u003c -50) AND (black_result = 'win'))) THEN ('Favorite won') WHEN (((rating_diff \u003e 50) AND (black_result = 'win'))) THEN ('Underdog won') WHEN (((rating_diff \u003c -50) AND (white_result = 'win'))) THEN ('Underdog won') WHEN ((winner IS NULL)) THEN ('Draw') ELSE 'Even match' END AS outcome_vs_expectation, ((white_rating + black_rating) / 2) AS avg_game_rating, CASE  WHEN ((((white_rating + black_rating) / 2) \u003e= 2500)) THEN ('Super GM (2500+)') WHEN ((((white_rating + black_rating) / 2) \u003e= 2200)) THEN ('Master (2200-2500)') WHEN ((((white_rating + black_rating) / 2) \u003e= 1800)) THEN ('Expert (1800-2200)') WHEN ((((white_rating + black_rating) / 2) \u003e= 1400)) THEN ('Intermediate (1400-1800)') ELSE 'Beginner (\u003c1400)' END AS rating_tier FROM read_parquet(main.list_value('/Users/bear/Github/data_playground/chess-analytics/rill/data/games_enriched.parquet')) WHERE (end_time IS NOT NULL)"}